import React, { useContext, useState, useEffect } from 'react';
import { GlobalContext } from '../App.jsx';
import { useNavigate } from 'react-router-dom';
import ArianeThread from '../components/ArianeThread.jsx';
import InstructionBanner from '../components/InstructionBanner.jsx';

function GetTicket() {

    const [inProcess, setInProcess] = useState(true);
    const navigate = useNavigate();
    const { cartStore } = useContext(GlobalContext);

    useEffect(() => {
        const timer = setTimeout(() => {
            setInProcess(false);
        }, 5000);

        const redirectTimer = setTimeout(() => {
            navigate('/Screensaver');
        }, 10000);

        return () => {
            clearTimeout(timer);
            cartStore.clearLocalStorage();
            clearTimeout(redirectTimer);
        };
    }, []);

    return (
        <main>
            {inProcess === true && (
                <section className='sm:hidden lg:block'>
                    <ArianeThread step={2} />
                    <div className='h-full flex flex-col justify-center items-center text-center mt-[50%]'>
                        <svg className='basis-full' width="240" height="240" viewBox="0 0 240 240" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M60 82.5C60 80.5109 60.7902 78.6032 62.1967 77.1967C63.6032 75.7902 65.5109 75 67.5 75H172.5C174.489 75 176.397 75.7902 177.803 77.1967C179.21 78.6032 180 80.5109 180 82.5C180 84.4891 179.21 86.3968 177.803 87.8033C176.397 89.2098 174.489 90 172.5 90H67.5C65.5109 90 63.6032 89.2098 62.1967 87.8033C60.7902 86.3968 60 84.4891 60 82.5ZM60 157.5C60 155.511 60.7902 153.603 62.1967 152.197C63.6032 150.79 65.5109 150 67.5 150H172.5C174.489 150 176.397 150.79 177.803 152.197C179.21 153.603 180 155.511 180 157.5C180 159.489 179.21 161.397 177.803 162.803C176.397 164.21 174.489 165 172.5 165H67.5C65.5109 165 63.6032 164.21 62.1967 162.803C60.7902 161.397 60 159.489 60 157.5ZM75 105C71.0218 105 67.2064 106.58 64.3934 109.393C61.5804 112.206 60 116.022 60 120C60 123.978 61.5804 127.794 64.3934 130.607C67.2064 133.42 71.0218 135 75 135H165C168.978 135 172.794 133.42 175.607 130.607C178.42 127.794 180 123.978 180 120C180 116.022 178.42 112.206 175.607 109.393C172.794 106.58 168.978 105 165 105H75Z" fill="#63579E" />
                            <path d="M0 67.5C0 61.5326 2.37053 55.8097 6.5901 51.5901C10.8097 47.3705 16.5326 45 22.5 45H217.5C223.467 45 229.19 47.3705 233.41 51.5901C237.629 55.8097 240 61.5326 240 67.5V90C240 91.9891 239.21 93.8968 237.803 95.3033C236.397 96.7098 234.489 97.5 232.5 97.5C226.533 97.5 220.81 99.8705 216.59 104.09C212.371 108.31 210 114.033 210 120C210 125.967 212.371 131.69 216.59 135.91C220.81 140.129 226.533 142.5 232.5 142.5C234.489 142.5 236.397 143.29 237.803 144.697C239.21 146.103 240 148.011 240 150V172.5C240 178.467 237.629 184.19 233.41 188.41C229.19 192.629 223.467 195 217.5 195H22.5C16.5326 195 10.8097 192.629 6.5901 188.41C2.37053 184.19 0 178.467 0 172.5L0 150C0 148.011 0.790176 146.103 2.1967 144.697C3.60322 143.29 5.51088 142.5 7.5 142.5C13.4674 142.5 19.1903 140.129 23.4099 135.91C27.6295 131.69 30 125.967 30 120C30 114.033 27.6295 108.31 23.4099 104.09C19.1903 99.8705 13.4674 97.5 7.5 97.5C5.51088 97.5 3.60322 96.7098 2.1967 95.3033C0.790176 93.8968 0 91.9891 0 90V67.5ZM22.5 60C20.5109 60 18.6032 60.7902 17.1967 62.1967C15.7902 63.6032 15 65.5109 15 67.5V83.25C23.4772 84.9714 31.0986 89.5705 36.5728 96.2681C42.0471 102.966 45.0376 111.35 45.0376 120C45.0376 128.65 42.0471 137.034 36.5728 143.732C31.0986 150.43 23.4772 155.029 15 156.75V172.5C15 174.489 15.7902 176.397 17.1967 177.803C18.6032 179.21 20.5109 180 22.5 180H217.5C219.489 180 221.397 179.21 222.803 177.803C224.21 176.397 225 174.489 225 172.5V156.75C216.523 155.029 208.901 150.43 203.427 143.732C197.953 137.034 194.962 128.65 194.962 120C194.962 111.35 197.953 102.966 203.427 96.2681C208.901 89.5705 216.523 84.9714 225 83.25V67.5C225 65.5109 224.21 63.6032 222.803 62.1967C221.397 60.7902 219.489 60 217.5 60H22.5Z" fill="#63579E" />
                        </svg>
                        <h2 className='text-5xl'>Impression de vos tickets en cours</h2>
                    </div>
                </section>
            )}
            {inProcess === false && (
                <section className='sm:hidden lg:block'>
                    <div className='h-full w-full flex flex-col justify-center items-center text-center  mt-[50%]'>
                        <svg className='basis-full' width="240" height="240" viewBox="0 0 240 240" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M60 82.5C60 80.5109 60.7902 78.6032 62.1967 77.1967C63.6032 75.7902 65.5109 75 67.5 75H172.5C174.489 75 176.397 75.7902 177.803 77.1967C179.21 78.6032 180 80.5109 180 82.5C180 84.4891 179.21 86.3968 177.803 87.8033C176.397 89.2098 174.489 90 172.5 90H67.5C65.5109 90 63.6032 89.2098 62.1967 87.8033C60.7902 86.3968 60 84.4891 60 82.5ZM60 157.5C60 155.511 60.7902 153.603 62.1967 152.197C63.6032 150.79 65.5109 150 67.5 150H172.5C174.489 150 176.397 150.79 177.803 152.197C179.21 153.603 180 155.511 180 157.5C180 159.489 179.21 161.397 177.803 162.803C176.397 164.21 174.489 165 172.5 165H67.5C65.5109 165 63.6032 164.21 62.1967 162.803C60.7902 161.397 60 159.489 60 157.5ZM75 105C71.0218 105 67.2064 106.58 64.3934 109.393C61.5804 112.206 60 116.022 60 120C60 123.978 61.5804 127.794 64.3934 130.607C67.2064 133.42 71.0218 135 75 135H165C168.978 135 172.794 133.42 175.607 130.607C178.42 127.794 180 123.978 180 120C180 116.022 178.42 112.206 175.607 109.393C172.794 106.58 168.978 105 165 105H75Z" fill="#63579E" />
                            <path d="M0 67.5C0 61.5326 2.37053 55.8097 6.5901 51.5901C10.8097 47.3705 16.5326 45 22.5 45H217.5C223.467 45 229.19 47.3705 233.41 51.5901C237.629 55.8097 240 61.5326 240 67.5V90C240 91.9891 239.21 93.8968 237.803 95.3033C236.397 96.7098 234.489 97.5 232.5 97.5C226.533 97.5 220.81 99.8705 216.59 104.09C212.371 108.31 210 114.033 210 120C210 125.967 212.371 131.69 216.59 135.91C220.81 140.129 226.533 142.5 232.5 142.5C234.489 142.5 236.397 143.29 237.803 144.697C239.21 146.103 240 148.011 240 150V172.5C240 178.467 237.629 184.19 233.41 188.41C229.19 192.629 223.467 195 217.5 195H22.5C16.5326 195 10.8097 192.629 6.5901 188.41C2.37053 184.19 0 178.467 0 172.5L0 150C0 148.011 0.790176 146.103 2.1967 144.697C3.60322 143.29 5.51088 142.5 7.5 142.5C13.4674 142.5 19.1903 140.129 23.4099 135.91C27.6295 131.69 30 125.967 30 120C30 114.033 27.6295 108.31 23.4099 104.09C19.1903 99.8705 13.4674 97.5 7.5 97.5C5.51088 97.5 3.60322 96.7098 2.1967 95.3033C0.790176 93.8968 0 91.9891 0 90V67.5ZM22.5 60C20.5109 60 18.6032 60.7902 17.1967 62.1967C15.7902 63.6032 15 65.5109 15 67.5V83.25C23.4772 84.9714 31.0986 89.5705 36.5728 96.2681C42.0471 102.966 45.0376 111.35 45.0376 120C45.0376 128.65 42.0471 137.034 36.5728 143.732C31.0986 150.43 23.4772 155.029 15 156.75V172.5C15 174.489 15.7902 176.397 17.1967 177.803C18.6032 179.21 20.5109 180 22.5 180H217.5C219.489 180 221.397 179.21 222.803 177.803C224.21 176.397 225 174.489 225 172.5V156.75C216.523 155.029 208.901 150.43 203.427 143.732C197.953 137.034 194.962 128.65 194.962 120C194.962 111.35 197.953 102.966 203.427 96.2681C208.901 89.5705 216.523 84.9714 225 83.25V67.5C225 65.5109 224.21 63.6032 222.803 62.1967C221.397 60.7902 219.489 60 217.5 60H22.5Z" fill="#63579E" />
                        </svg>
                        <h2 className='text-5xl'>Récupérez vos tickets</h2>
                        <div className='w-1/2 basis-full mt-10'>
                            <h2 className=' text-center text-5xl'>Votre commande porte le numéro :</h2>
                            <p className='text-primary-color text-9xl text-center mb-12'>#{cartStore.getNumeroCommand()}</p>
                            <InstructionBanner text="Merci pour votre achat ! Nous vous souhaitons une bonne exploration." />
                        </div>
                    </div>
                </section>
            )}
            <section className='sm:block lg:hidden p-6'>
                <div className='h-full w-full flex flex-col justify-center items-center text-center  mt-[50%]'>
                    <svg className='w-1/2' width="240" height="240" viewBox="0 0 240 240" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M60 82.5C60 80.5109 60.7902 78.6032 62.1967 77.1967C63.6032 75.7902 65.5109 75 67.5 75H172.5C174.489 75 176.397 75.7902 177.803 77.1967C179.21 78.6032 180 80.5109 180 82.5C180 84.4891 179.21 86.3968 177.803 87.8033C176.397 89.2098 174.489 90 172.5 90H67.5C65.5109 90 63.6032 89.2098 62.1967 87.8033C60.7902 86.3968 60 84.4891 60 82.5ZM60 157.5C60 155.511 60.7902 153.603 62.1967 152.197C63.6032 150.79 65.5109 150 67.5 150H172.5C174.489 150 176.397 150.79 177.803 152.197C179.21 153.603 180 155.511 180 157.5C180 159.489 179.21 161.397 177.803 162.803C176.397 164.21 174.489 165 172.5 165H67.5C65.5109 165 63.6032 164.21 62.1967 162.803C60.7902 161.397 60 159.489 60 157.5ZM75 105C71.0218 105 67.2064 106.58 64.3934 109.393C61.5804 112.206 60 116.022 60 120C60 123.978 61.5804 127.794 64.3934 130.607C67.2064 133.42 71.0218 135 75 135H165C168.978 135 172.794 133.42 175.607 130.607C178.42 127.794 180 123.978 180 120C180 116.022 178.42 112.206 175.607 109.393C172.794 106.58 168.978 105 165 105H75Z" fill="#63579E" />
                        <path d="M0 67.5C0 61.5326 2.37053 55.8097 6.5901 51.5901C10.8097 47.3705 16.5326 45 22.5 45H217.5C223.467 45 229.19 47.3705 233.41 51.5901C237.629 55.8097 240 61.5326 240 67.5V90C240 91.9891 239.21 93.8968 237.803 95.3033C236.397 96.7098 234.489 97.5 232.5 97.5C226.533 97.5 220.81 99.8705 216.59 104.09C212.371 108.31 210 114.033 210 120C210 125.967 212.371 131.69 216.59 135.91C220.81 140.129 226.533 142.5 232.5 142.5C234.489 142.5 236.397 143.29 237.803 144.697C239.21 146.103 240 148.011 240 150V172.5C240 178.467 237.629 184.19 233.41 188.41C229.19 192.629 223.467 195 217.5 195H22.5C16.5326 195 10.8097 192.629 6.5901 188.41C2.37053 184.19 0 178.467 0 172.5L0 150C0 148.011 0.790176 146.103 2.1967 144.697C3.60322 143.29 5.51088 142.5 7.5 142.5C13.4674 142.5 19.1903 140.129 23.4099 135.91C27.6295 131.69 30 125.967 30 120C30 114.033 27.6295 108.31 23.4099 104.09C19.1903 99.8705 13.4674 97.5 7.5 97.5C5.51088 97.5 3.60322 96.7098 2.1967 95.3033C0.790176 93.8968 0 91.9891 0 90V67.5ZM22.5 60C20.5109 60 18.6032 60.7902 17.1967 62.1967C15.7902 63.6032 15 65.5109 15 67.5V83.25C23.4772 84.9714 31.0986 89.5705 36.5728 96.2681C42.0471 102.966 45.0376 111.35 45.0376 120C45.0376 128.65 42.0471 137.034 36.5728 143.732C31.0986 150.43 23.4772 155.029 15 156.75V172.5C15 174.489 15.7902 176.397 17.1967 177.803C18.6032 179.21 20.5109 180 22.5 180H217.5C219.489 180 221.397 179.21 222.803 177.803C224.21 176.397 225 174.489 225 172.5V156.75C216.523 155.029 208.901 150.43 203.427 143.732C197.953 137.034 194.962 128.65 194.962 120C194.962 111.35 197.953 102.966 203.427 96.2681C208.901 89.5705 216.523 84.9714 225 83.25V67.5C225 65.5109 224.21 63.6032 222.803 62.1967C221.397 60.7902 219.489 60 217.5 60H22.5Z" fill="#63579E" />
                    </svg>
                    <h2 className='text-3xl'>Vos tickets sont disponibles dans l'onglet "Mes tickets" de votre application.</h2>
                    <div className='w-full basis-full mt-10'>
                        <InstructionBanner text="Merci pour votre achat ! Nous vous souhaitons une bonne exploration." />
                    </div>
                </div>
            </section>
        </main>
    );
}

export default GetTicket;
